<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Hamilton Rios</title>

     <!-- FAVICON -->
    <link rel="icon" href="./images/favicon.ico" />

    <!-- GOOGLE -->
    <meta name="google-signin-client_id"
       content="972835792340-3m1k3q9chcsv1vqfjoq3kiplnejt7tpf.apps.googleusercontent.com">
     <script src="https://apis.google.com/js/platform.js?onload=onLoadCallback" async defer></script>

    <!--  BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-uWxY/CJNBR+1zjPWmfnSnVxwRheevXITnMqoEIeG1LJrdI0GlVs/9cVSyPYXdcSF" crossorigin="anonymous">

    <!--  JQUERY -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!--  FONT AWESOME -->
    <link href="http://hamiltonrios.web.app/assets/css/all.min.css">

    <script defer src="http://hamiltonrios.web.app/assets/js/all.min.js"></script>

    <!--  PAPER DASHBOARD -->
    <link href="http://hamiltonrios.web.app/assets/css/animate.min.css" rel="stylesheet">
    <link href="http://hamiltonrios.web.app/assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://hamiltonrios.web.app/assets/css/paper-dashboard.css" rel="stylesheet">

    <!--  CUSTOM CODE -->
    <link href="http://hamiltonrios.web.app/assets/css/styles.css" rel="stylesheet">
    <link src="http://hamiltonrios.web.app/assets/css/animation.css" rel="stylesheet">

    <style media="screen">
        body {
            background: #ECEFF1;
            color: rgba(0, 0, 0, 0.87);
            font-family: Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
    </style>

</head>

<body>
    <div class="container-fluid">
        <div class="d-flex flex-column justify-content-center">

            <div class="card w-50 m-4 align-self-center p-4">
                <span style="color:#7A9E9F;font-size:xx-large!important;">Hamilton Rios<span
                        style="color:#555;font-size: medium;margin-left:1rem;"> Dashboard v1.0</span></span>
            </div>
            <div class="card w-50 m-2 align-self-center p-2">
                <div class="header">
                    <h4 class="title">Login</h4>
                </div>

                <div class="content">
                    <div class="row d-flex justify-content-center">

                        <form id='login-form' name="login-form" method="post" class="form">
                            <div id="login-card" class="form-group mw-75 px-2 ">
                                <label for='email'> email: </label>
                                <input id='email-login' name='email-login' class="form-control border-input mb-2"
                                    required />
                                <label for='password'> senha: </label>
                                <input id='password-login' name='password-login' class="form-control border-input mb-2"
                                    required type="password" />
                            </div>
                        </form>

                        <form id='signup-form' method="post" class="form">
                            <div id="signup-card" class="form-group mw-75 px-2 collapse">
                                <label for='email'> email: </label>
                                <input id='email-signup' name='email-signup' class="form-control border-input mb-2"
                                    required />
                                <label for='email'> senha: </label>
                                <input id='password-signup' name='password-signup'
                                    class="form-control border-input mb-2" required type="password" />
                                <label for='email'> confirmar senha: </label>
                                <input id='confirm-password' name='confirm-password'
                                    class="form-control border-input mb-2" required type="password" />
                            </div>
                        </form>
                    </div>

                    <div class="row mw-75">

                        <div id="google-login-div" class="d-flex flex-row justify-content-end col p-2">
                            <button id="google-logout" class="mx-2 btn btn-secondary" onclick="googleSignOut()">Sign Out</button>
                     
                            <div id="google-login" class="g-signin2 " style="text-transform:none"
                                data-onsuccess="onSignIn">
                                <img width="20px" style="margin-bottom:3px; margin-right:5px" alt="Google sign-in"
                                    src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png" />
                                Sign In
                            </div>
                        </div>
                       
                    </div>


                        <!-- <div id="submit-login-div" class="d-flex flex-row justify-content-end col">
                            <button id="signup-instead" class="btn btn-secondary m-2">Criar Conta</button>
                            <button id="submit-login" type="submit" form="login-form"
                                class="btn btn-primary m-2">Login</button>
                        </div>
                        <div id="submit-signup-div" class="d-flex flex-row justify-content-end col d-none">
                            <button id="login-instead" class="btn btn-secondary m-2">Ja tenho conta</button>
                            <button id="signup-submit" type="submit" form="submit-form"
                                class="btn btn-primary m-2">Cadastrar-se</button>
                        </div> -->
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="https://hamiltonrios.web.app/assets/js/jquery-1.10.2.js" type="text/javascript"></script>
    <script src="https://hamiltonrios.web.app/assets/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="https://hamiltonrios.web.app/assets/js/bootstrap-notify.js"></script>
    <script src="https://hamiltonrios.web.app/assets/js/paper-dashboard.js" type="text/javascript"></script>
  
    <script src="https://hamiltonrios.web.app/scripts/constants.js"></script>
  

    <script>
        var googleUser = {};

        window.onLoadCallback = function () {
            gapi.load('auth2', function () {
                auth2 = gapi.auth2.init({
                    client_id:"972835792340-3m1k3q9chcsv1vqfjoq3kiplnejt7tpf.apps.googleusercontent.com",
                    cookiepolicy: 'single_host_origin',
                });
                attachSignin( document.getElementById('google-login'));

            });
        };

        function googleSignOut() {
            var auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function () {
                console.log('User signed out.');
            });
            }

                               
        function attachSignin(element) {
            auth2.attachClickHandler(element, {}, function (googleUser) {
                $('#google-login').innerText = "Signed in as" + googleUser.getBasicProfile().getName();
                
            }, function (error) {
                console.log(JSON.stringify(error, undefined, 2));
            });
        }

        function onSignIn(googleUser) {

            var profile = googleUser.getBasicProfile();
            var username = profile.getName()
            localStorage.setItem("username", JSON.stringify(username))
         
            var id_token = googleUser.getAuthResponse().id_token;
            var xhr = new XMLHttpRequest();
            xhr.open('POST', BASEURL + '/login');
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.onload = function() {
                if(xhr.responseText == 'success')
                localStorage.setItem("current-user", id_token);
                console.log('Signed in as: ' + username );
                location.assign( BASEURL + '/dashboard' )
            };
            xhr.send(JSON.stringify({token: id_token}));
        }
        document.addEventListener('DOMContentLoaded', function () {

            const MODE = "login";

            $('#signup-instead').on('click', () => {
                $('#submit-login-div').addClass('d-none')
                $('#submit-signup-div').removeClass('d-none')
                $('#login-card').addClass('collapse')
                $('#signup-card').removeClass('collapse')
            })
            $('#login-instead').on('click', () => {
                $('#submit-login-div').removeClass('d-none')
                $('#submit-signup-div').addClass('d-none')
                $('#login-card').removeClass('collapse')
                $('#signup-card').addClass('collapse')
            })

            $('#login-form').on('submit', () => {

                $.ajax({
                    type: "POST",
                    url: BASEURL + '/login',
                    data: this.serialize(),

                })

            })

        })
    </script>

</body>

</html>